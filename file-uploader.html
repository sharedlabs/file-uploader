<link rel="import" href="../polymer/polymer.html">

<!--
`file-uploader`

@demo demo/index.html 
-->

<dom-module id="file-uploader">
  <template>
    <style>

      :host {
        display: block;
      }

      #droparea {
        height: 100%;
        width: 100%;
      }

    </style>

    <input id="fileInput"
        type="file"
        on-change="_inputChange"
        multiple="[[multiple]]"
        accept="[[accept]]"
        hidden>

    <div id="droparea">
      <content></content>
    </div>

  </template>
</dom-module>

<script>
(function() {
  'use strict';

  Polymer({

    is: 'file-uploader',

    properties: {

      autoUpload: {
        type: Boolean,
        value: false
      },

      multiple: {
        type: Boolean,
        value: true
      },

      accept: {
        type: String,
        value: 'image/*'
      },

      drop: {
        type: Boolean,
        value: false
      },

      files: {
        type: Array,
        notify: true,
        value: () => {
          return [];
        }
      }

    },

    selectFile() {
      this.$.fileInput.click();
    },

    uploadFile(file) {
      if (!(file instanceof File)) {
        throw new TypeError('the given file should be an instance of File');
      }
      // TODO: tengo que pensar mas todo esto...
    },

    _inputChange(event) {
      const files = event.target.files;

      for (let i = 0; i < files.length; i++) {
        this.push('files', files[i]);

        if (this.autoUpload) {
          this.uploadFile(files[i]);
        }
      }
    }

  });

}());
</script>